<!DOCTYPE html>
<html lang="en">
<head>
<title>Network setup info.</title>
<link href="css/normalize.css" rel="stylesheet" type="text/css" />
<link href="css/custom.css" rel="stylesheet" type="text/css" />
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1">
</head>
<body>
	<nav role="navigation">
		<a href="#" class="hidden-menu" onclick="ToggleHide('menu');" id="hidden-menu">&#9776;</a>
		<ul id="menu">
			<li><a href="index.html" class="menu">WIFISwitch</a></li>
			<li><a href="net.html" class="menu">Network</a></li>
			<li><a href="ap.html" class="menu">Stand-alone</a></li>
			<li><a href="restart.html" class="menu">Restart</a></li>			
			<li><a href="about.html" class="menu">About</a></li>
		</ul>
	</nav>
	<section>
	<!-- include header.html -->
		<h3>WIFISwitch configuration.</h3>
		<h4>Info:</h4>
		<p>Firmware version: <span id="fw_ver">0.0.0</span></p>
		<p>HTTP server version: <span id="httpd_ver">0.0.0</span></p>
		<p>DBFFS version: <span id="dbffs_ver">0.0.0</span></p>
		<p>Free memory: <span id="free_mem">?</span> bytes</p>
		<h4>Network config.</h4>
		<p>Mode: <span id="mode">unknown</span></p>
		<p>IP address: <span id="ip_addr">none</span></p>
		<p>Network name: <span id="network">none</span></p>
		<p>Hostname: <span id="hostname">none</span></p>
		<p><button type="button" onclick="SwitchMode()">Change mode</button></p>
		<br />
	<!-- include footer.html -->
	</section>
	<footer class="inverted">
		<small><span class="copyright">&copy; Copyright 2015 Martin Bo Kristensen Gr&oslash;nholdt.</span><a href="LICENSE.zip" class="license inverted">Read license (compressed).</a></small>
	</footer>
	<script src="js/request.js" type="text/javascript"></script>
	<script src="js/menu.js" type="text/javascript"></script>
	<script type="text/javascript">
		var fw_version = document.getElementById("fw_ver");
		var httpd_version = document.getElementById("httpd_ver");
		var dbffs_version = document.getElementById("dbffs_ver");
		var free_mem = document.getElementById("free_mem");
		var ip_addr = document.getElementById("ip_addr");
		var network = document.getElementById("network");
		var hostname = document.getElementById("hostname");
		var mode = document.getElementById("mode");

		function SwitchMode() {
			if (mode.innerHTML == "stand-alone") {
				mode.innerHTML = "network";
			}
			else
			{
				mode.innerHTML = "stand-alone";
			}
			JSONrequest('PUT', '/rest/net/network', function(data) {
			}, function() {
				mode.innerHTML = "Could not set mode.";
			}, "{ \"mode\" : \"" + mode.innerHTML + "\" }");
		}
		
		JSONrequest('GET', '/rest/fw/version', function(data) {
			fw_version.innerHTML = data.fw_ver;
			dbffs_version.innerHTML = data.dbffs_ver;
			httpd_version.innerHTML = data.httpd_ver;
		}, function() {
			fw_version.innerHTML = "Could not get firmware version.";
			dbffs_version.innerHTML = "Could not get file system version.";
			httpd_version.innerHTML = "Could not get HTTP server version.";
		});
		
		JSONrequest('GET', '/rest/fw/mem', function(data) {
			free_mem.innerHTML = data.free;
		}, function() {
			free_mem.innerHTML = "Could not get free memory.";
		});
		
		JSONrequest('GET', '/rest/net/network', function(data) {
			network.innerHTML = data.network;
			hostname.innerHTML = data.hostname;
			ip_addr.innerHTML = data.ip_addr;
			mode.innerHTML = data.mode;
		}, function() {
			network.innerHTML = "Could not get default network name.";
			hostname.innerHTML = "Could not get host name.";
			ip_addr.innerHTML = "Could net get IP address.";
		});
	</script>
</body>
<html></html>
